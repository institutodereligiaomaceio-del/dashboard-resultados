<script>
Papa.parse("Dashboard resultados 2025.csv", {
    download: true,
    header: true,
    skipEmptyLines: true,
    complete: function(results) {

        const dados = results.data;

        // Usa a primeira coluna como categoria (ex: curso, perÃ­odo, ano)
        const categorias = dados.map(d => Object.values(d)[0]);

        const matriculados = dados.map(d => Number(d["Matriculados"]));
        const aprovados    = dados.map(d => Number(d["Aprovados"]));
        const formandos    = dados.map(d => Number(d["Formandos"]));
        const avancados    = dados.map(d => Number(d["AvanÃ§ados"]));

        // ðŸ“Š GrÃ¡fico de barras
        Plotly.newPlot("graficoBarra", [
            { x: categorias, y: matriculados, name: "Matriculados", type: "bar" },
            { x: categorias, y: aprovados,    name: "Aprovados",    type: "bar" },
            { x: categorias, y: formandos,    name: "Formandos",    type: "bar" },
            { x: categorias, y: avancados,    name: "AvanÃ§ados",    type: "bar" }
        ], {
            title: "ComparaÃ§Ã£o de Resultados",
            barmode: "group"
        });

        // ðŸ“ˆ GrÃ¡fico de linha (desempenho)
        Plotly.newPlot("graficoLinha", [
            { 
                x: categorias, 
                y: aprovados, 
                name: "Aprovados", 
                type: "scatter", 
                mode: "lines+markers" 
            }
        ], {
            title: "EvoluÃ§Ã£o de Aprovados"
        });

        // ðŸ“‹ Tabela
        const tabela = document.getElementById("tabela");
        const colunas = Object.keys(dados[0]);

        tabela.innerHTML =
            "<tr>" + colunas.map(c => `<th>${c}</th>`).join("") + "</tr>" +
            dados.map(l =>
                "<tr>" + colunas.map(c => `<td>${l[c]}</td>`).join("") + "</tr>"
            ).join("");
    },
    error: function(err) {
        console.error("Erro ao carregar CSV:", err);
    }
});
</script>
